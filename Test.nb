(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12478,        340]
NotebookOptionsPosition[     10936,        307]
NotebookOutlinePosition[     11366,        324]
CellTagsIndexPosition[     11323,        321]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TrendDurationCountTableForTest", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"trendDurationFunction_", " ", ":", " ", "TrendDuration"}]}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"td", ",", "durations"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"td", " ", "=", " ", 
       RowBox[{"trendDurationFunction", "[", "data", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"durations", " ", "=", " ", 
       RowBox[{"Sort", "[", 
        RowBox[{"DeleteDuplicates", "[", "td", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"Count", "[", 
                RowBox[{"td", ",", "#"}], "]"}]}], "}"}], "&"}], ",", 
            "durations"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Duration\>\"", ",", "\"\<Count\>\""}], "}"}]}], "]"}],
         ",", 
        RowBox[{"Frame", "\[Rule]", "All"}], ",", 
        RowBox[{"Background", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"None", ",", 
           RowBox[{"{", "LightGreen", "}"}]}], "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TrendDurationSumCountTableForTest", "[", "data_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "upwardDurations", ",", "downwardDurations", ",", "allDurations"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"upwardDurations", " ", "=", " ", 
       RowBox[{"UpwardTrendDuration", "[", "data", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"downwardDurations", " ", "=", " ", 
       RowBox[{"DownwardTrendDuration", "[", "data", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allDurations", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"upwardDurations", ",", "downwardDurations"}], "]"}], "]"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{"upwardDurations", ",", "#"}], "]"}], "+", 
                RowBox[{"Count", "[", 
                 RowBox[{"downwardDurations", ",", "#"}], "]"}]}]}], "}"}], 
             "&"}], ",", "allDurations"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Duration\>\"", ",", "\"\<Count\>\""}], "}"}]}], "]"}],
         ",", 
        RowBox[{"Frame", "\[Rule]", "All"}], ",", 
        RowBox[{"Background", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"None", ",", 
           RowBox[{"{", "LightGreen", "}"}]}], "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8273249794715195`*^9, 3.8273250089638014`*^9}, {
  3.827325122749646*^9, 3.8273251451130505`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"748613bc-ac13-4ded-ba0c-05e7f61f15c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testDataRaw", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<test.dat\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8273248434811707`*^9, 3.827324876409638*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"5cf8632c-dba7-47b4-9adb-5ad331af3ad9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testData", " ", "=", " ", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "testDataRaw", "]"}], ",", "\"\<null\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8273248776114845`*^9, 3.8273249528271737`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"b058f46c-a716-4ea3-9bf9-f043473d723c"],

Cell["All trends", "Text",
 CellChangeTimes->{{3.8273250313584967`*^9, 
  3.8273250337501335`*^9}},ExpressionUUID->"36b94ab0-dbdb-4780-b4b4-\
60114cd64012"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrendDurationCountTableForTest", "[", 
  RowBox[{"testData", ",", "TrendDuration"}], "]"}]], "Input",
 CellChangeTimes->{{3.827325014277899*^9, 3.8273250206529193`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"513c05fe-42e9-49ca-9d12-3396e49afc56"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"Duration\"\>", "\<\"Count\"\>"},
    {"1", "2584"},
    {"2", "1294"},
    {"3", "648"},
    {"4", "329"},
    {"5", "145"},
    {"6", "67"},
    {"7", "48"},
    {"8", "19"},
    {"9", "14"},
    {"10", "3"},
    {"11", "2"},
    {"12", "2"},
    {"15", "1"},
    {"16", "1"}
   },
   AutoDelete->False,
   GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {
       RGBColor[0.88, 1, 0.88]}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.8273250211630836`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"2feaef55-e61a-40ca-a02b-bdc8d60ec5f6"]
}, Open  ]],

Cell["Upward and downward", "Text",
 CellChangeTimes->{{3.827325111778934*^9, 
  3.827325114532385*^9}},ExpressionUUID->"b4cfe492-1a3f-43ac-a8b5-\
dbd7a8e9379a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"TrendDurationCountTableForTest", "[", 
       RowBox[{"testData", ",", "UpwardTrendDuration"}], "]"}], ",", 
      "\"\<Upward\>\"", ",", "Top"}], "]"}], ",", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"TrendDurationCountTableForTest", "[", 
       RowBox[{"testData", ",", "DownwardDatedTrendDuration"}], "]"}], ",", 
      "\"\<Downward\>\"", ",", "Top"}], "]"}]}], "\[IndentingNewLine]", "}"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.827325040581518*^9, 3.8273251020066743`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"2b1fc714-50f7-45cc-b6b8-300dca7d5c05"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{
     TagBox[
      GridBox[{{"\"Duration\"", "\"Count\""}, {"1", "1251"}, {"2", "654"}, {
        "3", "328"}, {"4", "166"}, {"5", "79"}, {"6", "40"}, {"7", "31"}, {
        "8", "15"}, {"9", "9"}, {"10", "3"}, {"11", "2"}, {"12", "1"}, {
        "15", "1"}, {"16", "1"}}, AutoDelete -> False, 
       GridBoxBackground -> {"Columns" -> {{None}}, "Rows" -> {
           RGBColor[0.88, 1, 0.88]}}, 
       GridBoxFrame -> {"Columns" -> {{True}}, "Rows" -> {{True}}}, 
       GridBoxItemSize -> {
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
     "\"Upward\""}, "Labeled", DisplayFunction -> (GridBox[{{
        ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
        TagBox[
         ItemBox[
          PaneBox[
           TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
           BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
         "SkipImageSizeLevel"]}}, 
      GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
      AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      BaselinePosition -> {2, 1}]& ), 
    InterpretationFunction -> (RowBox[{"Labeled", "[", 
       RowBox[{#, ",", #2, ",", "Top"}], "]"}]& )], 
   TemplateBox[{
     TagBox[
      GridBox[{{"\"Duration\"", "\"Count\""}, {"1", "1334"}, {"2", "644"}, {
        "3", "320"}, {"4", "164"}, {"5", "64"}, {"6", "26"}, {"7", "17"}, {
        "8", "4"}, {"9", "5"}, {"12", "1"}}, AutoDelete -> False, 
       GridBoxBackground -> {"Columns" -> {{None}}, "Rows" -> {
           RGBColor[0.88, 1, 0.88]}}, 
       GridBoxFrame -> {"Columns" -> {{True}}, "Rows" -> {{True}}}, 
       GridBoxItemSize -> {
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], "Grid"], 
     "\"Downward\""}, "Labeled", DisplayFunction -> (GridBox[{{
        ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
        TagBox[
         ItemBox[
          PaneBox[
           TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
           BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
         "SkipImageSizeLevel"]}}, 
      GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
      AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      BaselinePosition -> {2, 1}]& ), 
    InterpretationFunction -> (RowBox[{"Labeled", "[", 
       RowBox[{#, ",", #2, ",", "Top"}], "]"}]& )]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.827325044891178*^9, 3.8273250678223057`*^9}, 
   3.8273251029435067`*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"39cca08f-a11a-42fd-9fc4-f5836a07b1c6"]
}, Open  ]],

Cell["Upward + Downward trend sum", "Text",
 CellChangeTimes->{{3.8273251615602083`*^9, 
  3.827325168219422*^9}},ExpressionUUID->"5eda6631-26e3-4afe-8f01-\
9701ef33e8e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrendDurationSumCountTableForTest", "[", "testData", "]"}]], "Input",
 CellChangeTimes->{{3.8273251550293913`*^9, 3.827325155693388*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"2768f593-7129-4f5d-8d06-ce92b59cfbfe"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"Duration\"\>", "\<\"Count\"\>"},
    {"1", "2585"},
    {"2", "1298"},
    {"3", "648"},
    {"4", "330"},
    {"5", "143"},
    {"6", "66"},
    {"7", "48"},
    {"8", "19"},
    {"9", "14"},
    {"10", "3"},
    {"11", "2"},
    {"12", "2"},
    {"15", "1"},
    {"16", "1"}
   },
   AutoDelete->False,
   GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {
       RGBColor[0.88, 1, 0.88]}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.827325156032787*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"732f5cc2-9fdd-4b31-8dd7-418c5abc7007"]
}, Open  ]]
},
WindowSize->{949., 472.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.1 para Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7192559f-2586-4119-bec1-e9d2f1c7e1b4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3506, 90, 259, "Input",ExpressionUUID->"748613bc-ac13-4ded-ba0c-05e7f61f15c4",
 InitializationCell->True],
Cell[4067, 112, 432, 11, 25, "Input",ExpressionUUID->"5cf8632c-dba7-47b4-9adb-5ad331af3ad9"],
Cell[4502, 125, 364, 9, 25, "Input",ExpressionUUID->"b058f46c-a716-4ea3-9bf9-f043473d723c"],
Cell[4869, 136, 156, 3, 31, "Text",ExpressionUUID->"36b94ab0-dbdb-4780-b4b4-60114cd64012"],
Cell[CellGroupData[{
Cell[5050, 143, 276, 5, 25, "Input",ExpressionUUID->"513c05fe-42e9-49ca-9d12-3396e49afc56"],
Cell[5329, 150, 725, 26, 267, "Output",ExpressionUUID->"2feaef55-e61a-40ca-a02b-bdc8d60ec5f6"]
}, Open  ]],
Cell[6069, 179, 161, 3, 31, "Text",ExpressionUUID->"b4cfe492-1a3f-43ac-a8b5-dbd7a8e9379a"],
Cell[CellGroupData[{
Cell[6255, 186, 728, 17, 76, "Input",ExpressionUUID->"2b1fc714-50f7-45cc-b6b8-300dca7d5c05"],
Cell[6986, 205, 2753, 57, 271, "Output",ExpressionUUID->"39cca08f-a11a-42fd-9fc4-f5836a07b1c6"]
}, Open  ]],
Cell[9754, 265, 171, 3, 31, "Text",ExpressionUUID->"5eda6631-26e3-4afe-8f01-9701ef33e8e1"],
Cell[CellGroupData[{
Cell[9950, 272, 244, 4, 25, "Input",ExpressionUUID->"2768f593-7129-4f5d-8d06-ce92b59cfbfe"],
Cell[10197, 278, 723, 26, 267, "Output",ExpressionUUID->"732f5cc2-9fdd-4b31-8dd7-418c5abc7007"]
}, Open  ]]
}
]
*)

